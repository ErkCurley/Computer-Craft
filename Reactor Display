reactor = peripheral.wrap("back")
mon = peripheral.wrap("top")
mon.clear()
mon.setBackgroundColor(colors.blue)
color = blue
 
--Case = 0
--fuel = 0
--maxFuel = 0
--rf = 0
 
function calc(min, max)
 
     percent = 53 / max
     
     x = percent * min
     
     -- print("percent: "..percent.." x: "..x)
     
     return 53, x
end
 
function progress(current,max,pos1,pos2,Color1,Color2)
 
--Power
 
 
 
  maxX,x = calc(current,max)
  for i=0,3 do
    if i == 1 then
      for z=1,maxX do
        mon.setCursorPos(pos1+z,pos2+i)
        if z <= x then
          mon.setBackgroundColor(Color1)
        else
          mon.setBackgroundColor(Color2)
        end
   
        mon.write(" ")
      end
    end
    if i == 3 then
      for z=1,maxX do
        mon.setCursorPos(pos1+z,pos2+i)
        if z<= x then
          mon.setBackgroundColor(Color1)
        else
          mon.setBackgroundColor(Color2)
        end
        mon.write(" ")
      end
    end
    if i == 2 then
      for z=1,maxX do
        mon.setCursorPos(pos1+z,pos2+i)
        if z<= x then
          mon.setBackgroundColor(Color1)
        else
          mon.setBackgroundColor(Color2)
        end
        mon.write(" ")
      end
    end
  end
end
 
function draw(color)
     mon.clear()
     
     Case = reactor.getCasingTemperature()
     maxCase = 2500
     fuel = reactor.getFuelAmount()
     maxFuel = reactor.getFuelAmountMax()
     rf = reactor.getEnergyProducedLastTick()
     maxRf = 10000
     
     mon.setCursorPos(32,1)
     mon.write("Reactor")
     
     mon.setCursorPos(4,1)
     mon.write("Case Temp:")
     mon.setCursorPos(4,2)
     mon.write("Centigrade")
     mon.setCursorPos(14,1)
     mon.write(math.floor(reactor.getCasingTemperature()))          
         
     mon.setCursorPos(2,10)
     mon.write("Fuel:")
     mon.setCursorPos(2,11)
     mon.write(math.floor((fuel/maxFuel)*100).."%")
     
     mon.setCursorPos(2,16)
     mon.write("Mb/t:")
     mon.setCursorPos(1,19)
     mon.write(math.floor(rf/1000).."Buckets/t")
     
     
     mon.setCursorPos(1,21)
     mon.write("Fuel Burnup Rate:")
     mon.setCursorPos(19,21)
     mon.write(math.floor(reactor.getFuelConsumedLastTick()*1000)/1000)
     
     progress(Case,maxCase,7,3,2,128)
     progress(fuel,maxFuel,7,9,16,8)
     progress(rf,maxRf,7,15,32,1)
 
--     mon.setCursorPos(8,4)
--     mon.write(reactor.getCasingTemperature())
         
     if reactor.getActive() == true then
       mon.setBackgroundColor(colors.blue)
     else
       mon.setBackgroundColor(colors.red)
     end
end
while true do
  draw(color)
 
   -- if reactor.getEnergyStored() >= 9000000 then
   --    reactor.setActive(false)
   --    mon.setBackgroundColor(colors.red)
   --    color = red
  --  end
   
  --  if reactor.getEnergyStored() <= (10000000/4) then
   --    reactor.setActive(true)
   --    mon.setBackgroundColor(colors.blue)
   --    color = blue
  --  end
   
   
    os.sleep(2)
  end
